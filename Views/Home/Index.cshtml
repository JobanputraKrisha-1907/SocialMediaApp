
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram clone </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <link href="~/Content/SideBar.css" rel="stylesheet" />
    <link href="~/Content/Style.css" rel="stylesheet" />
    <style>
        
        #closeButton {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 16px;
            cursor: pointer;
        }

            #closeButton:hover {
                background-color: rgba(0, 0, 0, 0.7);
            }

        .ftt {
            margin-left: 10px;
            display: flex;
            justify-content: end;
            height: 5vh;
        }
        

        .fa-heart {
            
            cursor: pointer;
        }
        /* Modal container */
        .modal .comment-container .comments {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
        }
        .comment {
            margin-top: 10px;
        }


        /* Modal content */
        .modal-content .comment-container .comments {
            background-color: #fefefe;
            margin: 10% auto; /* 10% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 50%; /* Could be more or less, depending on screen size */
            max-width: 500px; /* Max width */
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        }

        /* Close button */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

            .close:hover,
            .close:focus {
                color: black;
                text-decoration: none;
                cursor: pointer;
            }

    .progress-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background-color: #4CAF50;
    animation: progress 5s linear;
}

    @@keyframes progress {
    0% { width: 0; }
    100% { width: 100%; }
      }
        .overlay {
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            display: none;
            position: fixed;
            top: 30px; /* Half of the height */
            left: 547px; /* Half of the width */
            width: 480px;
            height: 600px; /* Height of the popup */
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow: hidden; /* To prevent scrolling within the popup */
            border-radius: 10px; /* Optional: adds rounded corners */
        }
        /* CSS for the popup */
        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.2);
            padding: 30px;
            width: 50%; /* Adjust width as needed */
            max-width: 800px; /* Maximum width for larger screens */
            z-index: 9999;
            height: 80%;
        }

        /* CSS for the left and right sections */
        .popup-left, .popup-right {
            width: 45%;
            height:50%;/* Adjust width as needed */
        }
        .popup-left{
          margin-right:10px;
        }

        .popup-body {
            display: flex; /* Use Flexbox */
            justify-content: space-around; /* Distribute space between child elements */
        }

        /* CSS for the left and right sections */
        .popup-left, .popup-right {
            flex: 1; /* Equal width for both sections */
        }


        /* CSS for the selected image */
        #selectedImagePreview img {
            max-width: 350px; /* Ensures the image fits within the container */
            max-height: 450px; /* Ensures the image fits within the container */
            display: block; /* Ensures the image behaves as a block element */
            margin: auto; /* Centers the image horizontally */
        }

        /* CSS for the input image field */
        #postImageInput {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        /* CSS for the caption box */
        #captionInput {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            resize: vertical; /* Allow vertical resizing */
        }

        /* CSS for the share button */
        #shareButton {
            background-color: #4CAF50;
            width:345px;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s; /* Add smooth transition */
        }

            /* Hover effect for the share button */
            #shareButton:hover {
                background-color: #45a049;
            }

        .sidebar2 {
            width: 0;
            background-color: #fff;
            position: fixed;
            top: 0;
            left: 245px;
            height: 100%;
            overflow-x: hidden;
            transition: 0.5s;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .notification-list {
            list-style-type: none;
            padding: 0;
        }

        /* Styles for each notification item */
        .notification {
            padding: 8px;
            margin-bottom: 5px;
            background-color: #ddd;
            border-radius: 5px;
        }
        .sidebar.open {
            width: 350px; /* Adjust as needed */
        }

        .reply {
            margin-left: 20px; /* Adjust the margin-left to increase or decrease the indentation */
            /* Additional styles for the reply comments */
        }

    </style>
</head>
<body>
    <div class="container">

        <nav>
            <div class="navbar" style="position:fixed">
                <div class="instagram-text-logo">
                    <img src="https://i.postimg.cc/qMFTcDw1/instagram-text.png" id="white-color" alt="">
                </div>

                <div class="sub-section" id="clicked">
                    <i class="fa-solid fa-circle-half-stroke"></i>
                    <a href="#">Dark Mode</a>
                </div>



                <div class="sub-section" id="searchBtn">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <a href="#">Search</a>
                </div>

                <div class="sub-section">
                    <i class="fa-regular fa-compass"></i>
                    <a href="@Url.Action("Explore", "Home")">Explore</a>
                </div>
                <div class="sub-section">
                    <i class="fa-solid fa-clapperboard"></i>
                    <a href="@Url.Action("Reels", "Home")">Reels</a>
                </div>
                <div class="sub-section">
                    <i class="fa-regular fa-message"></i>
                    <a href="@Url.Action("Message", "Home")">Messages</a>
                </div>

                <div class="sub-section" id="notification">
                    <i class="far fa-heart"></i>
                    <a href="#">Notification</a>
                </div>

                <div class="sub-section" id="hidden1">
                    <i class="fa-solid fa-square-plus"></i>
                    <a href="#">Create Post</a>
                </div>

                <div class="sub-section" id="hidden1">
                    <i class="fa-solid fa-circle-plus"></i>
                    <a href="#" id="createStoryLink">Create Story</a>
                </div>

                <!-- Popup for uploading story image -->
                <div id="storyPopup" style="display: none; position: fixed; top: 25%; left: 0; width: 100%; height: 100%; z-index: 9999;">
                    <div class="popup-content" style="background-color: #fefefe; margin:auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 400px; text-align: center;">
                        <span class="close" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                        <h2>Upload Story Image</h2>
                        <input type="file" id="storyImageInput" accept="image/*" style="display: block; margin: 20px auto;">
                        <div id="imagePreview" style="width: 150px; height: 150px; border-radius: 50%; overflow: hidden; margin: 20px auto; display:none">
                            <img id="previewImage" src="#" alt="" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <button id="postStoryBtn" style="display: block; margin: 0 auto; padding:10px;background-color:brown;color:white;">Post Story</button>
                    </div>
                </div>

                <div id="replyModal" style="display: none; position: fixed; top: 25%; left: 0; width: 100%; height: 100%; z-index: 9999;">
                    <div class="popup-content" style="background-color: #fefefe; margin:auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 400px; text-align: center;">
                        <span class="close" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                        <h2>Reply to Comment</h2>
                        <form id="replyForm">
                            <div class="form-group">
                                <textarea id="replyText" rows="4" style="width: 100%; margin-bottom: 15px;" placeholder="Type your reply here..."></textarea>
                            </div>
                        </form>
                        <button data-comment-id="" data-post-id="" id="sendReplyBtn" style="display: block; margin: 0 auto; padding: 10px; background-color: brown; color: white;">Send Reply</button>
                    </div>
                </div>




                <!-- HTML for the popup -->
                <div id="createPostPopup" class="popup" style="display:none">
                    <div class="popup-content p-3">
                        <span class="close">X</span>
                        <div class="popup-header">
                            <h1 class="mb-4">Create Post</h1>
                        </div>
                        <div class="popup-body">
                            <div class="popup-left">
                                <input type="file" id="postImageInput" class="form-control-file mb-3">
                                
                                <textarea id="captionInput" class="form-control mb-3" placeholder="Write a caption..." rows="5"></textarea>
                                <button class="btn btn-primary" id="shareButton">Share</button>

                            </div>
                            <div class="vertical-line"></div> <!-- Vertical line divider -->
                            <div class="popup-right">
                                <div id="selectedImagePreview"></div>
                            </div>
                        </div>
                    </div>
                </div>

                @*<div id="card">
            <div id="close-btn" onclick="closeStory()">×</div>
            <div id="full-screen"></div>
            <div id="progress-bar"></div>
        </div>*@

                <div class="sub-section">
                    @*<div class="profile-img">
                <img src="https://i.postimg.cc/zB3mRnhs/apy-logo.png" alt="">
            </div>*@
                    <i class="fa-solid fa-house-user"></i>
                    <a href="@Url.Action("Profile", "Home")">Profile</a>
                </div>

                <div class="sub-section" id="logoutButton">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <a href="#">Logout</a>
                </div>

                @*<div class="menu-section" id="hidden">
            <i class="fa-solid fa-bars"></i>
            <a href="#" id="moreLink">More</a>
        </div>*@



                <!-- Popup container -->
                <!--<div id="popup" style="display: none;">
        <button id="logoutButton">Logout</button>
    </div>-->


            </div>

        </nav>
        <div class="sidebar" id="sidebar">

            <div id="searchBarWrapper">
                <input type="text" id="searchInput" placeholder="Search...">
                <ul id="userList"></ul>
            </div>
        </div>

        <div class="sidebar2" id="sidebar2">
            <h2>Notifications</h2>
            <ul class="notification-list">
               
            </ul>

        </div>

        <!-- Modal -->
        @*<div id="commentModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <textarea id="commentTextarea" placeholder="Enter your comment..." style="width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;"></textarea>
                <button id="submitCommentBtn" style="display: block; margin: 0 auto; padding:10px;background-color:brown;color:white;">Submit</button>
            </div>
        </div>*@


        <div class="middle-section">
            <div class="post-section">
                <div class="nav-hidden">
                    <div class="nav-hidden-logo" id="white-2color">
                        <img src="https://i.postimg.cc/qMFTcDw1/instagram-text.png" alt="">
                    </div>
                    <div class="nav-hide-2">
                        <i class="fa-regular fa-heart"></i>
                        <i class="fa-regular fa-paper-plane"></i>
                    </div>
                </div>
                <div class="story-section" id="story-section">
                    
                    <div class="overlay" id="overlay">
                        
                            <button id="closeButton">X</button>
                        

                        <div class="progress-bar"></div>
                    </div>
                    <!--<div class="story">
                        <div class="story-image">
                            <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cHJvZmlsZSUyMGltYWdlfGVufDB8fDB8fHww&auto=format&fit=crop&w=600&q=60" alt="">
                        </div>-->
                        @*<span>Aaradhya_gu.</span>*@
                    <!--</div>-->




                </div>
                <div class="post-area" id="AppendPost">
                    @*<div class="post-main">
                        <div class="post-header">
                            <div class="post-left-header">
                                <div class="post-image">
                                    <img src="https://images.unsplash.com/photo-1461800919507-79b16743b257?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MjB8fG1lbnMlMjBpbWFnZXN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=600&q=60" alt="">
                                </div>
                                <p class="post-username">
                                    Vin Diesel
                                </p>
                                <i class="fa-solid fa-certificate"></i>
                                <span class="one-day"> . 1h </span>
                            </div>
                            <i class="fa-solid fa-grip-lines"></i>
                        </div>
                        <div class="post-main-image">
                            <img src="https://images.unsplash.com/photo-1535223289827-42f1e9919769?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTR8fHRlY2hub2xvZ3l8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=600&q=60" alt="">
                        </div>
                        <div class="post-fotter">
                            <div class="post-fotter-left">
                                <i class="fa-regular fa-heart"></i>
                                <i class="fa-regular fa-message"></i>
                                <i class="fa-regular fa-paper-plane"></i>
                            </div>
                            <i class="fa-regular fa-bookmark"></i>
                        </div>
                        <div class="post-description">
                            <p class="post-liked">Liked by sarasshree and others</p>
                            <p class="title"><span>balcoo </span>Monsoon fury rained havoc in various parts of Himachal Pradesh this year with the death toll crossing 260. The rains...<br> more</p>
                            <p class="comments"> view all comments</p>
                        </div>
                    </div>*@


                </div>
            </div>
            <div>
                <div class="suggestion-follow">
                    <p class="suggestion">---------------- Suggested for you ---------------</p>

                </div>
                <div class="follow-section" id="follow-section">

                    @*<div class="profile-follow profile-foolow-hovering">
                        <div class="profile-follow-left">
                            <div class="profile-follow-image">
                                <img src="https://i.postimg.cc/zB3mRnhs/apy-logo.png" alt="">
                            </div>
                            <div class="profile-follow-content">
                                <p class="profile-id">Aasu_Yadav_59</p>
                                <p class="profile-name">Aaasu Yadav</p>
                            </div>
                        </div>
                        <a href="#" class="follow">switch</a>
                    </div>*@



                </div>
            </div>
        </div>
    </div>

   

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/Script/Script.js"></script>
    <script>
        
        $(document).on("click", ".story", function () {
            const imageUrl = $(this).find(".story-image img").attr("src");
            const encodedImageUrl = encodeURI(imageUrl); // Encode the URL
            const overlay = $("#overlay");
            overlay.css("background-image", `url('${encodedImageUrl}')`);
            overlay.css("display", "flex"); // Changed to 'flex' for centering content
            const timeoutId = setTimeout(function () {
                overlay.css("display", "none");
            }, 5000);

            // Store timeout ID to clear it if overlay is closed manually
            overlay.data("timeoutId", timeoutId);
        });

        $(document).on("click", "#overlay, #closeButton", function () {
            const overlay = $("#overlay");
            overlay.css("display", "none");

            // Clear the timeout if overlay is closed manually
            const timeoutId = overlay.data("timeoutId");
    if (timeoutId) {
        clearTimeout(timeoutId);
        $(".story-image").css({
            "background-color": "grey",
            "background-image": "none"
        });
    }

            // Set background color of story to grey and remove background image
            $(".story-image").css({
                "background-color": "grey",
                "background-image": "none"
            });
        });




        

        // Flag to track if the content has been appended
        var contentAppended = false;

        // Function to append the content only once
        function appendContentOnce() {
            // Check if the content has been appended already
            if (!contentAppended) {
                // Append the content
                $('#follow-section').append('<div class="suggestion-follow"><p class="suggestion">---------------- Suggested for you ---------------</p></div>');

                // Set the flag to true to indicate that content has been appended
                contentAppended = true;
            }
        }

            // Call appendContentOnce() function when needed

        $('#submitCommentBtn').on('click', function () {
            // Get the value entered in the textarea
            var commentText = $('#commentTextarea').val();

            var UserId = localStorage.getItem('UserId');

            // Make AJAX call to submit the comment
            $.ajax({
                url: '/api/DefaultApi/SubmitComment', // Your API endpoint
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    PostID: PostId, // Replace postId with the ID of the post
                    UserID: UserId, // Replace userId with the ID of the current user
                    commentText: commentText
                }),
                success: function (response) {
                    // Handle success response if needed
                    // For example, you can append the comment to the UI
                    //$('#commentsContainer').append('<div class="comment">' + commentText + '</div>');
                    $('#commentTextarea').val('');
                    fetchAndDisplayComments(PostId);
                },
                error: function (xhr, status, error) {
                    // Handle error response
                    console.error('Error submitting comment:', error);
                }
            });
        });
        $(document).on("click", ".profile-follow-content", function () {
            // Find the user ID from the clicked element
            var userId = $(this).data('user-id');

            // Redirect to the SearchUser page with the user ID as a query parameter
            window.location.href = '/Home/SearchUser/?userId=' + userId;
        });

        function redirectToUser(userId) {
            // Redirect to the Searchuser view with the user's ID
            window.location.href = '/Home/SearchUser/?userId=' + userId;
            getUserIdFromUrl(userId);
        }
    </script>

</body>
</html>